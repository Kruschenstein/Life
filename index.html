<!DOCTYPE html>
<html>
    <head>
        <title>Game of Life</title>
        <meta charset="utf-8"/>
        <style>
            .container {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                grid-auto-rows: 25px;
                gap: 1px;
            }

            .item {
                background-color: blue;
            }

            .dead {
                background-color: darkviolet;
            }

            .alive {
                background-color: gold;
            }
        </style>
    </head>
    <body>
        <input id="pause" type="checkbox" onclick="pauseGeneration(this)"/>
        <label for="pause">Pause</label>
        <div class="container"></div>
    </body>
    <script>
        let pause = false;
        function pauseGeneration(elem) {
            pause = elem.checked;
        }

        document.body.onkeydown = (event) => {
            if (event.keyCode === 32 || event.keyCode === 80) {
                pause = !pause;
                document.getElementById("pause").checked = pause;
            }
        };

        const HEIGHT = 64;
        const WIDTH = 64;
        const CELLS = [];

        const container = document.getElementsByClassName("container")[0];
        container.style["grid-template-columns"] = `repeat(${WIDTH}, 1fr)`;
        for (let y = 0; y < HEIGHT; ++y) {
            for (let x = 0; x < WIDTH; ++x) {
                let div = document.createElement("div");
                div.state = 0;
                div.setAttribute("class", div.state === 1 ? "alive" : "dead");
                div.nextState = 0;
                div.onclick = () => {
                    div.state = (div.state + 1) % 2;
                    div.classList.remove("dead", "alive");
                    if (div.state === 1) {
                        div.classList.add("alive");
                    } else {
                        div.classList.add("dead");
                    }
                }
                container.appendChild(div);
                CELLS.push(div);
            }
        }

        for (let y = 0; y < HEIGHT; ++y) {
            for (let x = 0; x < WIDTH; ++x) {
                const neighboors = [
                    getNeighboor(CELLS, x - 1, y + 1),
                    getNeighboor(CELLS, x,     y + 1),
                    getNeighboor(CELLS, x + 1, y + 1),
                    getNeighboor(CELLS, x - 1, y),
                    getNeighboor(CELLS, x + 1, y),
                    getNeighboor(CELLS, x - 1, y - 1),
                    getNeighboor(CELLS, x    , y - 1),
                    getNeighboor(CELLS, x + 1, y - 1)
                ];
                CELLS[y * WIDTH + x].neighboors = neighboors.filter(elem => elem !== undefined);
            }
        }

        setInterval(() => {
            if (pause) {
                return;
            }

            for (let cell of CELLS) {
                const neighboorsSum = cell.neighboors.reduce((acc, elem) => acc + elem.state, 0);

                if (neighboorsSum === 3) {
                    cell.nextState = 1;
                } else if (neighboorsSum !== 2) {
                    cell.nextState = 0;
                } else {
                    cell.nextState = cell.state;
                }
            }
            nextGeneration(CELLS);

        }, 1000);

        function getNeighboor(cells, x, y) {
            if (x < 0 || x >= WIDTH || y < 0 || y >= HEIGHT) {
                return undefined;
            }
            return cells[y * WIDTH + x]
        }

        function nextGeneration(cells) {
            for (let cell of cells) {
                cell.state = cell.nextState;
                cell.setAttribute("class", cell.state === 1 ? "alive" : "dead");
            }
        }
    </script>
</html>